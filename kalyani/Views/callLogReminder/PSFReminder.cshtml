
@{
    ViewBag.Title = "PSFReminder";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<style>
    td, th {
        border: 1px solid black;
        overflow: hidden;
        text-align: center !important;
    }

    .dashImg1 {
        width: 37px;
    }

    .dashImg2 {
        width: 20px;
    }
</style>
<div class="row">

    <div class="col-sm-2">
        <!-- small box -->
        <div class="small-box bg-aqua">
            <div class="inner">
                    <h3 id="4thPSFFreshCallsCountCREMgr"><img class="dashImg1" src="~/public/img/loading.gif" /></h3>
                <p>Fresh PSF</p>
            </div>
            <div class="icon"> <i class="ion-android-call"></i> </div>

            <!--<span class="pull-left" data-toggle="modal" data-target=".myModal1">View Details</span>-->
        </div>
    </div>      <!-- ./col -->
    <div class="col-sm-2 col-half-offset">
        <!-- small box -->
        <div class="small-box bg-green">
            <div class="inner">
                <h3 id="4thPSFfollowupcountCREMgr"><img class="dashImg1" src="~/public/img/loading.gif" /></h3>
                <p>Pending Follow Ups</p>
            </div>
            <div class="icon"> <i class="ion-android-checkbox-outline"></i> </div>
        </div>
    </div>        <!-- ./col -->
    <div class="col-sm-2 col-half-offset">
        <!-- small box -->
        <div class="small-box bg-yellow">
            <div class="inner">
                <h3 id="4thPSFnonContactsCREMgr"><img class="dashImg1" src="~/public/img/loading.gif" /></h3>
                <p>Non Contacts</p>
            </div>
            <div class="icon"> <i class="ion-person-add"></i> </div>
        </div>
    </div>        <!-- ./col -->
    <div class="col-sm-2 col-half-offset">
        <!-- small box -->
        <div class="small-box bg-red">
            <div class="inner">
                <h3 id="4thPSFincompleteSurveyCountCREMgr"><img class="dashImg1" src="~/public/img/loading.gif" /></h3>
                <p>Incomplete Survey</p>
            </div>
            <div class="icon"> <i class="ion-android-download"></i> </div>
        </div>
    </div>
    <div class="col-sm-2 col-half-offset">
        <!-- small box -->
        <div class="small-box" style="background-color:#806517;">
            <div class="inner">
                <p style="margin:0 0 1px;color:#fff;">Surveys&nbsp;-&nbsp;<span id="4thPSFSurveysCREperDayMgr"><img class="dashImg2" src="~/public/img/loading.gif" /></span></p>
                <p style="margin:0 0 1px;color:#fff;">Contacts&nbsp;-&nbsp;<span id="4thPSFContactsCREperDayMgr"><img class="dashImg2" src="~/public/img/loading.gif" /></span></p>
                <p style="margin:0 0 1px;color:#fff;">Total Calls&nbsp;-&nbsp;<span id="4thPSFTotalCallsCREperDayMgr"><img class="dashImg2" src="~/public/img/loading.gif" /></span></p>
                <p style="margin:0 0 -5px;color:#fff;">Date&nbsp;-&nbsp;<span id="creCurrentdate">@DateTime.Now.ToString("dd/MM/yyyy")</span></p>
            </div>
        </div>
    </div>
    <!-- ./col -->

</div>


<div>

    <div class="panel panel-primary">
        <div class="panel-heading">
            PSF Call Log Information
            <button style="background-color:red;float:right;height:30px;width:100px;margin-top:-5px;" onclick="clearbucketfilters();" title="CLEAR FILTER">CLEAR FILTER</button>
        </div>
        <div class="panel-body">
            <ul class="nav nav-tabs">
                <li class="active bucket" id="li-psfscheduled" data-bucket="1">
                    <a class="nav-link" id="psfscheduled-tab" data-toggle="tab" href="#psfscheduled" role="tab" aria-controls="home" aria-selected="true">Scheduled</a>
                </li>
                <li class="bucket" id="li-psfpendingFollowUp" data-bucket="2">
                    <a class="nav-link" id="psfpendingFollowUp-tab" data-toggle="tab" href="#psfpendingFollowUp" role="tab" aria-controls="home" aria-selected="true">Follow Up Required</a>
                </li>
                <li class="bucket" id="li-psfincompleteSurvey" data-bucket="3">
                    <a class="nav-link" id="psfincompleteSurvey-tab" data-toggle="tab" href="#psfincompleteSurvey" role="tab" aria-controls="home" aria-selected="true">Incomplete Survey</a>
                </li>
                <li class="bucket" id="li-psfcompleteSurvey" data-bucket="4">
                    <a class="nav-link" id="psfcompleteSurvey-tab" data-toggle="tab" href="#psfcompleteSurvey" role="tab" aria-controls="home" aria-selected="true">Completed Survey</a>
                </li>
                <li class="bucket" id="li-pasfappointments" data-bucket="5">
                    <a class="nav-link" id="pasfappointments-tab" data-toggle="tab" href="#pasfappointments" role="tab" aria-controls="home" aria-selected="true">Appointments</a>
                </li>
                <li class="bucket" id="li-psfnonContact" data-bucket="6">
                    <a class="nav-link" id="psfnonContact-tab" data-toggle="tab" href="#psfnonContact" role="tab" aria-controls="home" aria-selected="true">Non Contacts</a>
                </li>
                <li class="bucket" id="li-psfdroped" data-bucket="7">
                    <a class="nav-link" id="psfdroped-tab" data-toggle="tab" href="#psfdroped" role="tab" aria-controls="home" aria-selected="true">Dropped</a>
                </li>

            </ul>
            <div class="tab-content">
                <div class="panel panel-default" style="border-top: #fff;">
                    <div class="panel-body">
                        <div class="row">
                            <div class="col-md-2 tab-pane" id="campaignDiv">

                                <label>Select Campaign</label>
                                @Html.DropDownList("ddlCampaign", new SelectList(ViewBag.ddlCampaign, "id", "campaignName"), "--Select--", new { @class = "form-control filter", @id = "campaignName", @data_field = "campaign", @onchange = "getfilters(this)" })
                            </div>

                            <div class="col-md-2" id="cityDiv">
                                <div class="form-group">
                                    <label>City </label>
                                    @Html.DropDownList("ddlLocation", new SelectList(ViewBag.ddllocation, "id", "location"), "--Select--", new { @class = "form-control filter", @data_field = "city", @id = "city", @onchange = "ajaxLoadWorkshopByCity();" })
                                </div>
                            </div>
                            <div class="col-md-2" id="workshopDiv">
                                <div class="form-group">
                                    <label>WorkShop Location </label>
                                    <select class="form-control filter" id="workshop" Workshop" data-field="workshopLoc" name="workshopId" onchange="ajaxCallToLoadCRESByWorkshop();">
                                        <option selected> -Select-</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-2" id="cresDiv">
                                <label>Select CRE's </label>
                                <div class="form-group">
                                    <select class="selectpicker filter form-control" placeholder="Select CRES" data-field="CRES" data-column-index="7" id="ddlCreIds" name="ddlCreIds" onchange="getfilters(this);" multiple></select>
                                </div>
                            </div>
                            <div class="col-md-2" id="fromDateDiv">
                                <label>From Assign Date : </label>
                                <input type="text" class="filter form-control datepicFromDropDown" data-column-index="1" id="fromduedaterange" name="fromduedaterange" data-field="fromassigndate" onchange="getfilters(this);" readonly>
                            </div>
                            <div class="col-md-2" id="toDateDiv">
                                <label>To Assign Date : </label>
                                <input type="text" class="filter form-control datepicToDropDown datePicker" data-column-index="2" id="toduedaterange" name="toduedaterange" data-field="toassigndate"  onchange="getfilters(this);" readonly>
                            </div>
                        </div>
                        <div class="row">

                            <div class="col-md-2" id="serviceTypeDiv" style="display:none;">
                                <label>Select PSF Day</label>
                                <select class="filter form-control" id="ServiceTypeName" data-column-index="3" name="ServiceTypeName" data-field="ServiceTypeName" onchange="getfilters(this);">
                                    <option value="0">--Select--</option>
                                    <option value="psf1stday">PSF 1st Day</option>
                                    <option value="psf3rdday">PSF 3rd Day</option>
                                    <option value="psf4thday">PSF 4th Day</option>
                                    <option value="psf6thday">PSF 6th Day</option>
                                    <option value="psf15thday">PSF 15th Day</option>
                                    <option value="psf30thday">PSF 30th Day</option>
                                </select>
                            </div>

                            <div class="col-md-3" id="serviceBookTypeDiv" style="display:none">
                                <label>Select Booked service type</label>
                                <select class="filter form-control" id="serviceBookedType" data-column-index="4" name="serviceBookedType" data-field="serviceBookedType" onchange="getfilters(this);">
                                    <option value="0">--Select--</option>


                                </select>
                            </div>
                            <div class="col-md-3" id="lastDispoTypeDiv" style="display:none">
                                <label>Last Disposition</label>
                                <select class="filter form-control" id="lastDispo" data-column-index="5" data-field="lastDispo" onchange="getfilters(this);">
                                    <option value="0">--Select--</option>
                                    @*@for (dispo < -dispoList)
                            {
                                <option value="@dispo.getDisposition()">@dispo.getDisposition()</option>

                            }*@


                                </select>
                            </div>
                            <div class="col-md-3" id="droppedcountDiv" style="display:none">
                                <label>Dropped Count</label>
                                <select class="filter form-control" id="droppedCount" data-column-index="6" data-field="droppedCount" onchange="getfilters(this);">
                                    <option value="0">--Select--</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>


                <div class="tab-pane fade in active" id="psfscheduled">
                    <div class="panel-body inf-content">


                        <div class="dataTable_wrapper">
                            <div>
                                <table class="table table-striped table-bordered table-hover" id="PSFassignedInteractionTableMR" width="100%">
                                    <thead>
                                        <tr>
                                            <th>Campaign Name</th>
                                            <th>CRE Name</th>
                                            <th>Customer Name</th>
                                            <th>Mobile Number</th>
                                            <th>Vehicle Reg No</th>
                                            <th>Model</th>
                                            <th>RONumber</th>
                                            <th>RODate</th>
                                            <th>Bill Date</th>
                                            <th>Category</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="buttons"></div>
                </div>
                <div class="tab-pane fade" id="psfpendingFollowUp">
                    <div class="panel-body inf-content">
                        <div class="dataTable_wrapper">
                            <div>
                                <table class="table table-striped table-bordered table-hover" id="PSFfollowUpRequiredServerDataMR4" width="100%">
                                    <thead>
                                        <tr>
                                            <th>Campaign Name</th>
                                            <th>CRE Name</th>
                                            <th>Customer Name</th>
                                            <th>Mobile Number</th>
                                            <th>Vehicle RegNo.</th>
                                            <th>FollowUp Date</th>
                                            <th>FollowUp Time</th>
                                            <th>Call date</th>
                                            <th>RO Number</th>
                                            <th>RO Date</th>
                                            <th>Bill&nbsp;Date</th>
                                            <th>Survey Date</th>
                                            <th>Model</th>

                                        </tr>
                                    </thead>
                                    <tbody>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="buttons"></div>
                </div>
                <div class="tab-pane fade" id="psfincompleteSurvey">
                    <div class="panel-body inf-content">
                        <div class="dataTable_wrapper">
                            <div>
                                <table class="table table-striped table-bordered table-hover" id="PSFfollowUpRequiredServerDataMR22" width="100%">
                                    <thead>
                                        <tr>
                                            <th>Campaign Name</th>
                                            <th>CRE Name</th>
                                            <th>Customer Name</th>
                                            <th>Mobile Number</th>
                                            <th>Vehicle RegNo.</th>
                                            <th>Call date</th>
                                            <th>RO Number</th>
                                            <th>RO Date</th>
                                            <th>Bill&nbsp;Date</th>
                                            <th>Survey Date</th>
                                            <th>Model</th>

                                        </tr>
                                    </thead>
                                    <tbody>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="buttons"></div>
                </div>
                <div class="tab-pane fade" id="psfcompleteSurvey">
                    <div class="panel-body inf-content">
                        <div class="dataTable_wrapper">
                            <div>
                                <table class="table table-striped table-bordered table-hover" id="PSFfollowUpRequiredServerDataMR36" width="100%">
                                    <thead>
                                        <tr>
                                            <th>Campaign Name</th>
                                            <th>CRE Name</th>
                                            <th>Customer Name</th>
                                            <th>Mobile Number</th>
                                            <th>Vehicle RegNo.</th>
                                            <th>Call date</th>
                                            <th>RO Number</th>
                                            <th>RO Date</th>
                                            <th>Bill&nbsp;Date</th>
                                            <th>Survey Date</th>
                                            <th>Model</th>
                                            <th>PSF Appointment Date</th>
                                            <th>PSF Appointment Time</th>

                                        </tr>
                                    </thead>
                                    <tbody>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="buttons"></div>
                </div><!--End tab panel-->

                <div class="tab-pane fade" id="pasfappointments">
                    <div class="panel-body inf-content">
                        <div class="dataTable_wrapper">
                            <div>
                                <table class="table table-striped table-bordered table-hover" id="PSFfollowUpRequiredServerDataMR25" width="100%">
                                    <thead>
                                        <tr>
                                            <th>Campaign Name</th>
                                            <th>CRE Name</th>
                                            <th>Customer Name</th>
                                            <th>Mobile Number</th>
                                            <th>Vehicle RegNo.</th>
                                            <th>Call date</th>
                                            <th>RO Number</th>
                                            <th>RO Date</th>
                                            <th>Bill&nbsp;Date</th>
                                            <th>Survey Date</th>
                                            <th>Model</th>
                                            <th>PSF Appointment Date</th>
                                            <th>PSF Appointment Time</th>

                                        </tr>
                                    </thead>
                                    <tbody>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="buttons"></div>
                </div><!--End tab panel-->
                <div class="tab-pane fade " id="psfnonContact">
                    <div class="panel-body inf-content">
                        <div>
                            <table class="table table-striped table-bordered table-hover" id="PSFnonContactsServerDataMR1" width="100%">
                                <thead>
                                    <tr>
                                        <th>Campaign Name</th>
                                        <th>CRE Name</th>
                                        <th>Customer Name</th>
                                        <th>Mobile Number</th>
                                        <th>Vehicle RegNo.</th>
                                        <th>Call date</th>
                                        <th>RO Number</th>
                                        <th>Bill&nbsp;Date</th>
                                        <th>Survey Date</th>
                                        <th>Model</th>
                                        <th>Last Disposition</th>

                                    </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="buttons"></div>
                </div>
                <div class="tab-pane fade" id="psfdroped">
                    <div class="panel-body inf-content">
                        <div class="dataTable_wrapper">
                            <div style="overflow-x: auto">
                                <table class="table table-striped table-bordered table-hover" id="PSFnonContactsServerDataMR2" width="100%">
                                    <thead>
                                        <tr>
                                            <th>Campaign Name</th>
                                            <th>CRE Name</th>
                                            <th>Customer Name</th>
                                            <th>Mobile Number</th>
                                            <th>Vehicle RegNo.</th>
                                            <th>Call date</th>
                                            <th>RO Number</th>
                                            <th>Bill&nbsp;Date</th>
                                            <th>Survey Date</th>
                                            <th>Model</th>
                                            <th>Last Disposition</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="buttons"></div>
                </div>
                <div class="buttons hide"></div>
                <div class="row">
                    <div class="col-md-12 col-sm-12">
                        <span class="code" id="tblException" style="font-size:11pt;font-weight:bold;"></span>
                    </div>
                </div>
            </div><!--End tab content-->
                        </div><!--End panel body-->
                    </div>

</div>
@section scripts
{
    <script type="text/javascript">
        var presentBucket = "", filtDist = {}, callAjaxClear = 0, callfromTab = 0;

        function calldashboardCount()
        {
            var psfid = $('#campaignName').val();

            $.ajax({
                type: "POST",
                url: siteRoot + "/callLogReminder/loadPSFDashboardCounts/",
                data: { psfID: psfid},
                cache: false,
                success: function (res) {
                    if (res.success == true) {
                        $('#4thPSFFreshCallsCountCREMgr').text(res.fourthPSFFreshCallsCountCREMgr);
                        $('#4thPSFfollowupcountCREMgr').text(res.fourthPSFfollowupcountCREMgr);
                        $('#4thPSFnonContactsCREMgr').text(res.fourthPSFnonContactsCREMgr);
                        $('#4thPSFincompleteSurveyCountCREMgr').text(res.fourthPSFincompleteSurveyCountCREMgr);
                        $('#4thPSFSurveysCREperDayMgr').text(res.fourthPSFSurveysCREperDayMgr);
                        $('#4thPSFContactsCREperDayMgr').text(res.fourthPSFContactsCREperDayMgr);
                        $('#4thPSFTotalCallsCREperDayMgr').text(res.fourthPSFTotalCallsCREperDayMgr);
                    }
                    else {
                        Lobibox.notify('warning', {
                            msg: res.error
                        });
                    }
                },
                error: function (data) {
                    alert("Cann't load Dashboard count, Error occured while processing data");
                }
            });

        }
        $(document).ready(function () {


            calldashboardCount();

            //getDataFor==1 ----> 1,2,3 is bucket number
            $(".datePicker").datepicker({
                autoclose: true,
                dateFormat: 'yy/mm/dd',
            });

            $('.datepicFromDropDown').datepicker({

                autoclose: true,
                dateFormat: 'yy-mm-dd',
                //maxDate: new Date(),
                onSelect: function (date) {
                    $('.datepicToDropDown').datepicker("destroy");
                    $('.datepicToDropDown').datepicker("destroy");
                    $('.datepicToDropDown').datepicker({
                        autoclose: true,
                        dateFormat: 'yy-mm-dd',
                        minDate: $('.datepicFromDropDown').datepicker('getDate')
                    });
                    $(this).trigger('change');
                    var dt1 = $('.datepicFromDropDown').datepicker('getDate');
                    var dt2 = $('.datepicToDropDown').datepicker('getDate');
                    if (dt2 <= dt1) {
                        var minDate = $('#dt2').datepicker('option', 'minDate');
                        $('.datepicToDropDown').datepicker('setDate', null);
                    }
                }
            })

            if (localStorage.length > 0) {
                filtDist = JSON.parse(localStorage.getItem("psfReminder"));
                if (filtDist != null) {
                    renderFilterData();
                }
                else {
                    presentBucket = 1;
                    filtDist = {};
                    bindScheduleData();
                }
            }
            else {
                presentBucket = 1;
                bindScheduleData();
            }


        });


        function renderFilterData() {
            //debugger;
            for (var key in filtDist) {
                if (key !== "getDataFor" && key !== "isFiltered") {
                    var element = $('.filter[data-field="' + key + '"]');
                    $(element).val(filtDist[key]);
                }
            }
            if (filtDist["getDataFor"] != null) {
                presentBucket = filtDist["getDataFor"];
                var liElement = $('.bucket[data-bucket="' + presentBucket + '"]');
                var id = liElement[0].id;
                //removing current style
                $('li.bucket').removeClass('active');
                $('div.fade').removeClass('show active in');

                //applying new style
                $('#' + id).addClass('active');
                $('#' + id.split('-')[1]).addClass('show active in');

               // manageFilters(presentBucket);
                makeAjaxCall();
            }
        }


        $('li.bucket').on('click', function () {

            var id = $(this).attr('id');
            //removing current style
            $('li.bucket').removeClass('active');
            $('div.fade').removeClass('show active in');

            //applying new style
            $('#' + id).addClass('active');
            $('#' + id.split('-')[1]).addClass('show active in');
            presentBucket = $(this).attr('data-bucket');
           // manageFilters(presentBucket);
            makeAjaxCall();
        })


        function getfilters(item) {
            //debugger;
            var field = $(item).attr('data-field');
            var data = $(item).val();
            if (field == "CRES") {
                data = $('#ddlCreIds option:selected').toArray().map(item => item.value).join();
                //alert(data);
            }
            if (filtDist[field] === undefined) {
                filtDist[field] = data;
                if (data != "") {
                    filtDist["isFiltered"] = true;
                }
                else {


                    if ($('#campaignName').val() === "" && $('#city').val() === "" && $('#workshop').val() === "" && $('#ddlCreIds').val() === "" &&
                        $('#fromduedaterange').val() === "" && $('#toduedaterange').val() === ""  && $('#ServiceTypeName').val() === "" && $('#serviceBookedType').val() === "" && $('#lastDispo').val() === "")
                    {
                        filtDist["isFiltered"] = false;
                    }
                }
            }
            else {
                filtDist[field] = data;
                if (data != "") {
                    filtDist["isFiltered"] = true;
                }
                else if ($('#campaignName').val() === "" && $('#city').val() === "" && $('#workshop').val() === "" && $('#ddlCreIds').val() === "" &&
                    $('#fromduedaterange').val() === "" && $('#toduedaterange').val() === "" && $('#ServiceTypeName').val() === "" && $('#serviceBookedType').val() === "" && $('#lastDispo').val() === "")
                {
                    filtDist["isFiltered"] = false;
                }

            }
            //calling ajax function
            makeAjaxCall();
        }

        //                    campaignName  city workshop ddlCreIds fromduedaterange toduedaterange ServiceTypeName serviceBookedType serviceBookedType  lastDispo

        function makeAjaxCall() {
            calldashboardCount();
            if (presentBucket == 1) {
                bindScheduleData();
            }
            else if (presentBucket == 2) {
                bindfollowupData();
            }
            else if (presentBucket == 3) {
                bindincompletesurvey();
            }
            else if (presentBucket == 4) {
                bindcompletesurvey();
            }
            else if (presentBucket == 5) {
                bindappointments();
            }
            else if (presentBucket == 6) {
                bindNonContacts();
            }
            else if (presentBucket == 7) {
                binddropped();
            } 
        }


        function recordFilters() {
            localStorage.setItem("psfReminder", JSON.stringify(filtDist));
        }

        //Clear Buckets data
        function clearbucketfilters() {



            $('#city').val('');
            $('#workshop').prop('selectedIndex', 0);
            $("#ddlCreIds").empty();
            $("#ddlCreIds").multiselect('refresh');
            $('#campaignName').val('');
            $('#fromduedaterange').val('');
            $('#toduedaterange').val('');
            $('#ServiceTypeName').val('');
            $('#serviceBookedType').prop('selectedIndex', 0);
            $('#lastDispo').prop('selectedIndex', 0);
            filtDist = {};

            makeAjaxCall();
        }


        function bindScheduleData() {
            //debugger;
            filtDist["getDataFor"] = 1;
            $('#PSFassignedInteractionTableMR').DataTable({
                "destroy": true,
                dom: 'Blfrtip',
                buttons: ['excel'],
                "ajax": {
                    "url": siteRoot + "/callLogReminder/getPSFBucket/",
                    "type": "POST",
                    "datatype": "json",
                    "data": { psfreminderData: JSON.stringify(filtDist) }
                },

                "columns": [
                    
                    { "data": "campaignName", "name": "campaignName" },
                    { "data": "CREName", "name": "CREName" },
                    { "data": "customer_name", "name": "customer_name" },
                    { "data": "Mobile_number", "name": "Mobile_number" },
                    { "data": "vehicle_RegNo", "name": "vehicle_RegNo" },
                    { "data": "model", "name": "model" },
                    { "data": "RONumber", "name": "RONumber" },
                  
                    {
                        "data": "ROdate", "render": function (data, type, row) {
                            return parseJsonDateTime(data);
                        }
                    },
                    {
                        "data": "BillDate", "render": function (data, type, row) {
                            return parseJsonDateTime(data);
                        }
                    },
                    { "data": "category", "name": "category" }
                ],
                "initComplete": function (data) {
                    $('#tblException').text(data.json.exception);
                    // filtercountDisplay();

                }, dom: 'lBfrtip',
                buttons: [
                    'copyHtml5',
                    {
                        extend: 'excelHtml5',
                        filename: 'ScheduledcallData'
                    },
                    {
                        extend: 'csvHtml5',
                        filename: 'ScheduledCallData'
                    }
                ],
                "serverSide": "true",
                "processing": "true",
                "serverSide": true,
                "scrollX": "true",
                "scrollY": "300",
                "paging": "true",
                "searching": true,
                "lengthMenu": [100, 200, 500, 1000],
                "pageLength": 100,
                "language": {
                    "processing": "Loading Please Wait.....!"
                }
            });
        }

        // FollowUp bucket

        function bindfollowupData() {
            //debugger;
            filtDist["getDataFor"] = 2;
            $('#PSFfollowUpRequiredServerDataMR4').DataTable({
                "destroy": true,
                dom: 'Blfrtip',
                buttons: ['excel'],
                "ajax": {
                    "url": siteRoot + "/callLogReminder/getPSFBucket/",
                    "type": "POST",
                    "datatype": "json",
                    "data": { psfreminderData: JSON.stringify(filtDist) }
                },

                "columns": [

                    { "data": "campaignName", "name": "campaignName" },
                    { "data": "CREName", "name": "CREName" },
                    { "data": "customer_name", "name": "customer_name" },
                    { "data": "Mobile_number", "name": "Mobile_number" },
                    { "data": "vehicle_RegNo", "name": "vehicle_RegNo" },

                    {
                        "data": "followUpDate", "render": function (data, type, row) {
                            return parseJsonDateTime(data);
                        }
                    },
                    { "data": "followUpTime", "name": "followUpTime" },

                    {
                        "data": "call_date", "render": function (data, type, row) {
                            return parseJsonDateTime(data);
                        }
                    },
                    { "data": "RONumber", "name": "RONumber" },
                    {
                        "data": "ROdate", "render": function (data, type, row) {
                            return parseJsonDateTime(data);
                        }
                    },
                    {
                        "data": "BillDate", "render": function (data, type, row) {
                            return parseJsonDateTime(data);
                        }
                    },
                    {
                        "data": "Servey_date", "render": function (data, type, row) {
                            return parseJsonDateTime(data);
                        }
                    },
                    { "data": "model", "name": "model" }
                ],
                "initComplete": function (data) {
                    $('#tblException').text(data.json.exception);

                }, dom: 'lBfrtip',
                buttons: [
                    'copyHtml5',
                    {
                        extend: 'excelHtml5',
                        filename: 'followupData'
                    },
                    {
                        extend: 'csvHtml5',
                        filename: 'folowupData'
                    }
                ],
                "serverSide": "true",
                "processing": "true",
                "serverSide": true,
                "scrollX": "true",
                "scrollY": "300",
                "paging": "true",
                "searching": true,
                "lengthMenu": [100, 200, 500, 1000],
                "pageLength": 100,
                "language": {
                    "processing": "Loading Please Wait.....!"
                }
            });
        }



        //incomplete survey

        function bindincompletesurvey() {
            //debugger;
            filtDist["getDataFor"] = 3;
            $('#PSFfollowUpRequiredServerDataMR22').DataTable({
                "destroy": true,
                dom: 'Blfrtip',
                buttons: ['excel'],
                "ajax": {
                    "url": siteRoot + "/callLogReminder/getPSFBucket/",
                    "type": "POST",
                    "datatype": "json",
                    "data": { psfreminderData: JSON.stringify(filtDist) }
                },

                "columns": [
                    { "data": "campaignName", "name": "campaignName" },
                    { "data": "CREName", "name": "CREName" },

                    { "data": "customer_name", "name": "customer_name" },
                    { "data": "Mobile_number", "name": "Mobile_number" },
                    { "data": "vehicle_RegNo", "name": "vehicle_RegNo" },
                    {
                        "data": "call_date", "render": function (data, type, row) {
                            return parseJsonDateTime(data);
                        }
                    },
                    { "data": "RONumber", "name": "RONumber" },
                    {
                        "data": "ROdate", "render": function (data, type, row) {
                            return parseJsonDateTime(data);
                        }
                    },
                    {
                        "data": "BillDate", "render": function (data, type, row) {
                            return parseJsonDateTime(data);
                        }
                    },
                    {
                        "data": "Servey_date", "render": function (data, type, row) {
                            return parseJsonDateTime(data);
                        }
                    },
                    { "data": "model", "name": "model" }
                ],
                "initComplete": function (data) {
                    $('#tblException').text(data.json.exception);

                }, dom: 'lBfrtip',
                buttons: [
                    'copyHtml5',
                    {
                        extend: 'excelHtml5',
                        filename: 'incompleteSurvey'
                    },
                    {
                        extend: 'csvHtml5',
                        filename: 'incompleteSurvey'
                    }
                ],
                "serverSide": "true",
                "processing": "true",
                "serverSide": true,
                "scrollX": "true",
                "scrollY": "300",
                "paging": "true",
                "searching": true,
                "lengthMenu": [100, 200, 500, 1000],
                "pageLength": 100,
                "language": {
                    "processing": "Loading Please Wait.....!"
                }
            });
        }


        //complete survey
        function bindcompletesurvey() {
            //debugger;
            filtDist["getDataFor"] = 4;
            $('#PSFfollowUpRequiredServerDataMR36').DataTable({
                "destroy": true,
                dom: 'Blfrtip',
                buttons: ['excel'],
                "ajax": {
                    "url": siteRoot + "/callLogReminder/getPSFBucket/",
                    "type": "POST",
                    "datatype": "json",
                    "data": { psfreminderData: JSON.stringify(filtDist) }
                },

                "columns": [

                    { "data": "campaignName", "name": "campaignName" },
                    { "data": "CREName", "name": "CREName" },
                    { "data": "customer_name", "name": "customer_name" },
                    { "data": "Mobile_number", "name": "Mobile_number" },
                    { "data": "vehicle_RegNo", "name": "vehicle_RegNo" },
                    {
                        "data": "call_date", "render": function (data, type, row) {
                            return parseJsonDateTime(data);
                        }
                    },
                    { "data": "RONumber", "name": "RONumber" },
                    {
                        "data": "ROdate", "render": function (data, type, row) {
                            return parseJsonDateTime(data);
                        }
                    },
                    {
                        "data": "BillDate", "render": function (data, type, row) {
                            return parseJsonDateTime(data);
                        }
                    },
                    {
                        "data": "Servey_date", "render": function (data, type, row) {
                            return parseJsonDateTime(data);
                        }
                    },
                    { "data": "model", "name": "model" },

                    {
                        "data": "psfAppointmentDate", "render": function (data, type, row) {
                            return parseJsonDateTime(data);
                        }
                    },
                    { "data": "psfAppointmentTime", "name": "psfAppointmentTime" }
                ],
                "initComplete": function (data) {
                    $('#tblException').text(data.json.exception);

                }, dom: 'lBfrtip',
                buttons: [
                    'copyHtml5',
                    {
                        extend: 'excelHtml5',
                        filename: 'completeSurvey'
                    },
                    {
                        extend: 'csvHtml5',
                        filename: 'complteSurvey'
                    }
                ],
                "serverSide": "true",
                "processing": "true",
                "serverSide": true,
                "scrollX": "true",
                "scrollY": "300",
                "paging": "true",
                "searching": true,
                "lengthMenu": [100, 200, 500, 1000],
                "pageLength": 100,
                "language": {
                    "processing": "Loading Please Wait.....!"
                }
            });
        }

        //appointments
        function bindappointments() {
            //debugger;
            filtDist["getDataFor"] = 5;
            $('#PSFfollowUpRequiredServerDataMR25').DataTable({
                "destroy": true,
                dom: 'Blfrtip',
                buttons: ['excel'],
                "ajax": {
                    "url": siteRoot + "/callLogReminder/getPSFBucket/",
                    "type": "POST",
                    "datatype": "json",
                    "data": { psfreminderData: JSON.stringify(filtDist) }
                },

                "columns": [

                    { "data": "campaignName", "name": "campaignName" },
                    { "data": "CREName", "name": "CREName" },
                    { "data": "customer_name", "name": "customer_name" },
                    { "data": "Mobile_number", "name": "Mobile_number" },
                    { "data": "vehicle_RegNo", "name": "vehicle_RegNo" },

                    {
                        "data": "call_date", "render": function (data, type, row) {
                            return parseJsonDateTime(data);
                        }
                    },
                    { "data": "RONumber", "name": "RONumber" },
                    {
                        "data": "ROdate", "render": function (data, type, row) {
                            return parseJsonDateTime(data);
                        }
                    },
                    {
                        "data": "BillDate", "render": function (data, type, row) {
                            return parseJsonDateTime(data);
                        }
                    },
                    {
                        "data": "Servey_date", "render": function (data, type, row) {
                            return parseJsonDateTime(data);
                        }
                    },
                    { "data": "model", "name": "model" },
                    
                    {
                        "data": "psfAppointmentDate", "render": function (data, type, row) {
                            return parseJsonDateTime(data);
                        }
                    },
                    { "data": "psfAppointmentTime", "name": "psfAppointmentTime" }

                ],
                "initComplete": function (data) {
                    $('#tblException').text(data.json.exception);

                }, dom: 'lBfrtip',
                buttons: [
                    'copyHtml5',
                    {
                        extend: 'excelHtml5',
                        filename: 'Appointments'
                    },
                    {
                        extend: 'csvHtml5',
                        filename: 'Appointments'
                    }
                ],
                "serverSide": "true",
                "processing": "true",
                "serverSide": true,
                "scrollX": "true",
                "scrollY": "300",
                "paging": "true",
                "searching": true,
                "lengthMenu": [100, 200, 500, 1000],
                "pageLength": 100,
                "language": {
                    "processing": "Loading Please Wait.....!"
                }
            });
        }

        //noncontact
        function bindNonContacts() {
            //debugger;
            filtDist["getDataFor"] = 6;
            $('#PSFnonContactsServerDataMR1').DataTable({
                "destroy": true,
                dom: 'Blfrtip',
                buttons: ['excel'],
                "ajax": {
                    "url": siteRoot + "/callLogReminder/getPSFBucket/",
                    "type": "POST",
                    "datatype": "json",
                    "data": { psfreminderData: JSON.stringify(filtDist) }
                },

                "columns": [

                    { "data": "campaignName", "name": "campaignName" },
                    { "data": "CREName", "name": "CREName" },
                    { "data": "customer_name", "name": "customer_name" },
                    { "data": "Mobile_number", "name": "Mobile_number" },
                    { "data": "vehicle_RegNo", "name": "vehicle_RegNo" },
                    {
                        "data": "call_date", "render": function (data, type, row) {
                            return parseJsonDateTime(data);
                        }
                    },
                    { "data": "RONumber", "name": "RONumber" },

                    {
                        "data": "BillDate", "render": function (data, type, row) {
                            return parseJsonDateTime(data);
                        }
                    },
                    {
                        "data": "Servey_date", "render": function (data, type, row) {
                            return parseJsonDateTime(data);
                        }
                    },
                    { "data": "model", "name": "model" },
                    { "data": "Last_disposition", "name": "Last_disposition" }
                ],
                "initComplete": function (data) {
                    $('#tblException').text(data.json.exception);

                }, dom: 'lBfrtip',
                buttons: [
                    'copyHtml5',
                    {
                        extend: 'excelHtml5',
                        filename: 'nonContacts'
                    },
                    {
                        extend: 'csvHtml5',
                        filename: 'nonContacts'
                    }
                ],
                "serverSide": "true",
                "processing": "true",
                "serverSide": true,
                "scrollX": "true",
                "scrollY": "300",
                "paging": "true",
                "searching": true,
                "lengthMenu": [100, 200, 500, 1000],
                "pageLength": 100,
                "language": {
                    "processing": "Loading Please Wait.....!"
                }
            });
        }

        //dropped
        function binddropped() {
            //debugger;
            filtDist["getDataFor"] = 7;
            $('#PSFnonContactsServerDataMR2').DataTable({
                "destroy": true,
                dom: 'Blfrtip',
                buttons: ['excel'],
                "ajax": {
                    "url": siteRoot + "/callLogReminder/getPSFBucket/",
                    "type": "POST",
                    "datatype": "json",
                    "data": { psfreminderData: JSON.stringify(filtDist) }
                },

                "columns": [

                    { "data": "campaignName", "name": "campaignName" },
                    { "data": "CREName", "name": "CREName" },
                    { "data": "customer_name", "name": "customer_name" },
                    { "data": "Mobile_number", "name": "Mobile_number" },
                    { "data": "vehicle_RegNo", "name": "vehicle_RegNo" },
                    {
                        "data": "call_date", "render": function (data, type, row) {
                            return parseJsonDateTime(data);
                        }
                    },
                    { "data": "RONumber", "name": "RONumber" },
                    {
                        "data": "BillDate", "render": function (data, type, row) {
                            return parseJsonDateTime(data);
                        }
                    },
                    {
                        "data": "Servey_date", "render": function (data, type, row) {
                            return parseJsonDateTime(data);
                        }
                    },
                    { "data": "model", "name": "model" },
                    { "data": "Last_disposition", "name": "Last_disposition" }

                ],
                "initComplete": function (data) {
                    $('#tblException').text(data.json.exception);

                }, dom: 'lBfrtip',
                buttons: [
                    'copyHtml5',
                    {
                        extend: 'excelHtml5',
                        filename: 'dropped'
                    },
                    {
                        extend: 'csvHtml5',
                        filename: 'dropped'
                    }
                ],
                "serverSide": "true",
                "processing": "true",
                "serverSide": true,
                "scrollX": "true",
                "scrollY": "300",
                "paging": "true",
                "searching": true,
                "lengthMenu": [100, 200, 500, 1000],
                "pageLength": 100,
                "language": {
                    "processing": "Loading Please Wait.....!"
                }
            });
        }



        function ajaxLoadWorkshopByCity() {


            var selectedCity = document.getElementById('city').value;
            var urlLink = siteRoot + "/callLogReminder/listWorkshops/";

            $.ajax({
                type: 'POST',
                url: urlLink,
                datatype: 'json',
                data: { selectedCity: selectedCity },
                cache: false,
                success: function (workshoplist) {

                    if (workshoplist != null) {
                        $('#workshop').empty();
                        var dropdown = document.getElementById("workshop");
                        dropdown[0] = new Option('select', '0');

                        for (var i = 0; i < workshoplist.length; i++) {
                            $('#workshop').append('<option value="' + workshoplist[i].id + '">' + workshoplist[i].workshopName + '</option>');
                        }
                    }
                }, error(error) {
                    console.log(error);
                }
            });
        }


        function ajaxCallToLoadCRESByWorkshop() {
            $('#ddlCreIds').empty();
            var workshopId = document.getElementById('workshop').value;
            var urlLink = siteRoot + "/callLogReminder/getCRESListBasedOnWorkshop/";
            $.ajax({
                type: 'POST',
                url: urlLink,
                datatype: 'json',
                data: { workshopId: workshopId, crefor: "PSF" },
                cache: false,
                success: function (crelist) {
                    console.log(crelist);
                    $('#ddlCreIds').empty();
                    var dropdown = document.getElementById("ddlCreIds");
                    for (var i = 0; i < crelist.length; i++) {
                        dropdown[dropdown.length] = new Option(crelist[i].creName, crelist[i].id);
                        $("#ddlCreIds").addClass('selectpicker');
                        $('#ddlCreIds').multiselect('rebuild');
                    }
                }, error(error) {

                }
            });
        }

    </Script>
}


