@model IEnumerable<AutoSherpa_project.Models.callinteraction>
@{
    ViewBag.Title = "FollowUpToday";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<style>
    td, th {
        border: 1px solid black;
        overflow: hidden;
        text-align: center !important;
    }
</style>

<div class="row">
    <div class="col-lg-12">
        <div class="panel panel-info">
            <div class="panel-heading">
                @if (ViewBag.role != true)
                {
                    @Html.ActionLink("Back", "Service", "CREServiceLog", null, new { @class = "fa fa-arrow-left btn btn-primary btn-xs pull-right" })
                }
                else
                {
                    @Html.ActionLink("Back", "Insurance", "CREInsurance", null, new { @class = "fa fa-arrow-left btn btn-primary btn-xs pull-right" })
                }

                Follow Up Required Calls Of Today
            </div>

            <div class="panel-body">
                <div class="dataTable_wrapper">
                    <div style="overflow-x: auto">
                        <table class="table table-striped table-bordered table-hover" id="dataTables-example15">
                            <thead>
                                <tr>
                                    <th>Customer Name</th>
                                    <th>Mobile Number</th>
                                    <th>Vehicle RegNo.</th>
                                    <th>Model</th>
                                    <th>IsBooked</th>
                                    <th>Follow Up Time</th>
                                    <th>Disposition Form</th>
                                </tr>
                            </thead>
                            <tbody>
                                @if (Model != null)
                                {
                                    foreach (var post in Model)
                                    {
                                        <tr>
                                            <td>@post.customer.customerName</td>
                                            <td>
                                                @if (post.customer.phones.FirstOrDefault(m => m.isPreferredPhone == true) != null)
                                                {
                                                    @post.customer.phones.FirstOrDefault(m => m.isPreferredPhone == true).phoneNumber
                                                }
                                            </td>
                                            <td>@post.vehicle.vehicleRegNo</td>
                                            <td>@post.vehicle.model</td>
                                            @if (ViewBag.role == false)
                                            {
                                                if (post.servicebooked != null)
                                                {
                                                    <td><span class="label" style="font-size: small;background-color: #369680 !important;">Booked</span></td>
                                                }
                                                else
                                                {
                                                    <td>Not Booked</td>
                                                }
                                                <td>@post.srdispositions.FirstOrDefault().followUpTime</td>
                                                <td>@Html.ActionLink(" ", "redirectToCallLogging", "Home", new { @id = "CRE,S," + post.customer.id + "," + post.vehicle.vehicle_id }, new { @class = "fa fa-pencil-square", @data_toggel = "tooltip", @title = "Disposition", @style = "font-size:30px;color:#DD4B39;" })</td>
                                            }

                                            @if (ViewBag.role == true)
                                            {
                                                if (post.appointmentbooked != null)
                                                {
                                                    <td><span class="label" style="font-size: small;background-color: #369680 !important;">Booked</span></td>
                                                }
                                                else
                                                {
                                                    <td>Not Booked</td>
                                                }
                                                <td>@post.insurancedispositions.FirstOrDefault().followUpTime</td>
                                                <td>@Html.ActionLink(" ", "redirectToCallLogging", "Home", new { @id = "CRE,I," + post.customer.id + "," + post.vehicle.vehicle_id }, new { @class = "fa fa-pencil-square", @data_toggel = "tooltip", @title = "Disposition", @style = "font-size:30px;color:#DD4B39;" })</td>
                                            }
                                        </tr>
                                    }
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <span id="spanException" class="text-danger" style="font-size:13pt"></span>
        </div>
    </div>
</div>

@section scripts
   {

    @if (ViewBag.error != null)
    {
        <script>
            $('#spanException').text('@ViewBag.error');
        </script>
    }
    else
    {
        <script>
            $('#spanException').text('');
        </script>
    }

    <script type="text/javascript">
        $(document).ready(function () {
            $("#dataTables-example15").addClass("nowrap");
            $("#dataTables-example15").dataTable({
                //destroy: true
                responsive: true,
                columnDefs: [
                    { targets: [-7, -3], className: 'dt-body-right' }
                ]
            });
        });

    </script>

}